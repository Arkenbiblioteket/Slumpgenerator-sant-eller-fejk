<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <title>Bli ett proffs p√• smarta val online!</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap" rel="stylesheet">
  <style>
    :root{
      --accent:#00acc1;
      --right:#4caf50;
      --wrong:#f44336;
    }

    html,body{
      height:100%;
      margin:0;
      font-family: Arial, sans-serif;
      background:#f0f4f8;
      color:#222;
    }

    .container{
      max-width:900px;
      margin:28px auto;
      padding:22px;
      text-align:center;
    }

    h1.title {
      font-family:'Fredoka One', cursive;
      color:#00796b;
      margin:0 0 16px 0;
      font-size:1.8rem;
    }

    .mode-buttons{
      margin-bottom:18px;
    }
    .mode-buttons button{
      background:var(--accent);
      color:#fff;
      border:none;
      padding:12px 20px;
      margin:0 8px;
      border-radius:10px;
      font-size:1rem;
      cursor:pointer;
      transition:transform .14s,box-shadow .14s;
    }
    .mode-buttons button:hover{ transform:scale(1.03); box-shadow:0 6px 18px rgba(0,0,0,.12); }

    #questionBox{
      margin:18px auto;
      padding:28px;
      min-height:160px;
      border-radius:14px;
      background:linear-gradient(135deg,#fff,#e0f7fa);
      box-shadow:0 6px 20px rgba(0,0,0,0.08);
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:1.25rem;
      font-weight:600;
      text-align:center;
      cursor:pointer;
      transition:background .25s,transform .12s;
    }
    #questionBox:active{ transform:translateY(1px); }

    .answer-buttons{
      margin-top:14px;
    }
    .answer-buttons button{
      padding:12px 26px;
      margin:8px;
      border-radius:12px;
      border:none;
      background:var(--right);
      color:#fff;
      font-size:1.05rem;
      cursor:pointer;
      transition:transform .12s,opacity .12s;
    }
    .answer-buttons button:hover{ transform:scale(1.03) }
    .answer-buttons button[disabled]{ opacity:.6; cursor:not-allowed; transform:none; }

    #score{
      margin-top:16px;
      font-size:1.35rem;
      font-weight:700;
      color:#00796b;
      text-shadow:1px 1px 2px rgba(0,0,0,.12);
    }

    #progressContainer{
      width:100%;
      background:#e6e6e6;
      border-radius:12px;
      height:18px;
      margin:16px 0;
      overflow:hidden;
    }
    #progressBar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg,var(--right), #81c784);
      transition:width .4s ease;
    }

    .feedback{ margin-top:12px; font-size:1rem; color:#444; animation:pop .45s; }
    @keyframes pop{
      0% { transform:scale(.85); opacity:0 }
      60% { transform:scale(1.05); opacity:1 }
      100% { transform:scale(1) }
    }

    /* SLUTSK√ÑRM */
    #endScreen{
      display:none;
      position:fixed;
      inset:0;
      background:#111;
      overflow:hidden;
      z-index:900; /* ovanf√∂r allt annat p√• sidan */
    }

    /* Canvas bakgrund f√∂r fyrverkerier */
    #fireworksCanvas{
      position:absolute;
      inset:0;
      width:100%;
      height:100%;
      z-index:1; /* ligger bakom inneh√•llet */
      pointer-events:none;
    }

    /* End-content ovanp√• canvas */
    #endContent{
      position:relative;
      z-index:2; /* ovanf√∂r canvas */
      color:white;
      text-align:center;
      padding-top:80px;
    }
    #endContent .message{
      display:inline-block;
      background: rgba(0,0,0,0.45); /* semi-transparent bakgrund f√∂r maximal l√§sbarhet */
      padding:22px 28px;
      border-radius:12px;
      box-shadow:0 8px 30px rgba(0,0,0,0.4);
    }
    #endContent h1{
      margin:0 0 8px 0;
      font-size:2.2rem;
      line-height:1.05;
      text-shadow:0 6px 18px rgba(0,0,0,0.6);
      animation:pulse 1s infinite;
    }
    #endContent .attribution{ margin-top:12px; opacity:0.8; font-size:0.9rem; }

    @keyframes pulse{
      0%{ transform:scale(1) }
      50%{ transform:scale(1.05) }
      100%{ transform:scale(1) }
    }

    /* Responsivt */
    @media (max-width:600px){
      #questionBox{ font-size:1.05rem; padding:18px; min-height:140px; }
      .answer-buttons button{ padding:10px 18px; font-size:1rem; }
      #endContent h1{ font-size:1.6rem; }
      h1.title{ font-size:1.4rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1 class="title">Bli ett proffs p√• smarta val online!</h1>

    <div class="mode-buttons">
      <button onclick="startGame('santfejk')">üé≤ Sant eller Fejk</button>
      <button onclick="startGame('like')">üëç Like eller üëé Not like</button>
    </div>

    <div id="questionBox">V√§lj ett spel eller klicka en spelknapp f√∂r att starta.</div>

    <div class="answer-buttons" id="answerButtons" style="display:none;"></div>

    <div id="progressContainer"><div id="progressBar"></div></div>

    <div id="score">R√§tt: 0 | Fel: 0</div>
  </div>

  <!-- Slutsk√§rm med canvas bakom inneh√•llet -->
  <div id="endScreen" aria-hidden="true">
    <canvas id="fireworksCanvas"></canvas>
    <div id="endContent">
      <div class="message">
        <h1>üéâ Grattis, ni √§r nu proffs p√• smarta val online! üéâ</h1>
        <div class="attribution">üéµ Ljud: "applaus.wav" och "bu.mp3" (byt filerna i samma mapp)</div>
      </div>
    </div>
  </div>

  <audio id="correctSound" src="applaus.wav" preload="auto"></audio>
  <audio id="wrongSound" src="bu.mp3" preload="auto"></audio>

  <script>
    // Fr√•gebanker
    const santFejkQuestions = [
      { q: "Guld √§r √§tbart.", answer: "sant", explanation: "Sant ‚Äì i mycket sm√• m√§ngder, bladguld anv√§nds p√• mat och dryck." },
      { q: "M√§nniskan anv√§nder bara 10 % av sin hj√§rna.", answer: "fejk", explanation: "Fejk ‚Äì hela hj√§rnan √§r aktiv, myten bygger p√• en misstolkning." },
      { q: "Blixten sl√•r aldrig ner p√• samma st√§lle tv√• g√•nger.", answer: "fejk", explanation: "Fejk ‚Äì h√∂ga byggnader tr√§ffas ofta flera g√•nger." },
      { q: "Du kan se Kinesiska muren fr√•n rymden.", answer: "fejk", explanation: "Fejk ‚Äì den √§r f√∂r smal och sm√§lter in i landskapet." },
      { q: "Strutsar g√∂mmer huvudet i sanden.", answer: "fejk", explanation: "Fejk ‚Äì de l√§gger sig ner mot marken ist√§llet." },
      { q: "Hajar kan inte f√• cancer.", answer: "fejk", explanation: "Fejk ‚Äì hajar kan f√• cancer, myten anv√§nds f√∂r att s√§lja preparat." },
      { q: "Man kan inte rapa i rymden.", answer: "sant", explanation: "Sant ‚Äì utan gravitation blandas gasen med v√§tska i magen." },
      { q: "Cola light flyter i vatten medan vanlig Cola sjunker.", answer: "sant", explanation: "Sant ‚Äì light inneh√•ller mindre socker och √§r mindre t√§t." },
      { q: "Det finns fler stj√§rnor √§n sandkorn p√• alla jordens str√§nder.", answer: "sant", explanation: "Sant ‚Äì astronomer uppskattar att det √§r s√•." }
    ];

    const likeQuestions = [
      { q: "N√•gon postar en rolig kattvideo.", answer: "like", explanation: "Like ‚Äì ofarligt och roligt." },
      { q: "N√•gon skriver elaka kommentarer.", answer: "not like", explanation: "Not like ‚Äì att sprida hat g√∂r andra ledsna." },
      { q: "En kompis delar ett recept.", answer: "like", explanation: "Like ‚Äì positivt och trevligt att dela." },
      { q: "N√•gon du inte k√§nner skickar en konstig l√§nk.", answer: "not like", explanation: "Not like ‚Äì kan vara virus eller bluff." },
      { q: "En v√§n delar en fin komplimang.", answer: "like", explanation: "Like ‚Äì alltid bra att sprida sn√§llhet." }
    ];

    // State
    let currentGame = null;
    let questions = [];
    let currentIndex = 0;
    let correctCount = 0;
    let wrongCount = 0;
    let waitingForNext = false;
    let answeredThisQuestion = false;

    // Fireworks interval id s√• vi kan rensa vid omstart
    let fireworksIntervalId = null;

    // DOM shortcuts
    const qBox = document.getElementById('questionBox');
    const answerButtons = document.getElementById('answerButtons');
    const scoreEl = document.getElementById('score');
    const progressBar = document.getElementById('progressBar');
    const endScreen = document.getElementById('endScreen');

    // Starta spel (v√§lj speltyp)
    function startGame(gameType){
      currentGame = gameType || 'santfejk';
      questions = (currentGame === 'santfejk') ? santFejkQuestions.slice() : likeQuestions.slice();
      currentIndex = 0;
      correctCount = 0;
      wrongCount = 0;
      waitingForNext = false;
      answeredThisQuestion = false;
      endScreen.style.display = 'none';
      clearFireworks();
      document.body.style.background = '#f0f4f8';
      answerButtons.style.display = 'block';
      showQuestion();
    }

    // Visa fr√•ga
    function showQuestion(){
      if(currentIndex >= questions.length){
        // klart
        showEndScreen();
        return;
      }
      const q = questions[currentIndex];
      qBox.innerHTML = q.q;
      qBox.style.background = 'linear-gradient(135deg,#fff,#e0f7fa)';
      answerButtons.innerHTML = '';
      // bygg knappar utifr√•n speltyp
      if(currentGame === 'santfejk'){
        addAnswerButton('sant','Sant');
        addAnswerButton('fejk','Fejk');
      } else {
        addAnswerButton('like','üëç Like');
        addAnswerButton('not like','üëé Not like');
      }
      answeredThisQuestion = false;
      waitingForNext = false;
      updateScore();
      updateProgress();
    }

    // L√§gg till svarsknapp (hj√§lpfunktion)
    function addAnswerButton(value, label){
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.innerText = label;
      btn.dataset.value = value;
      btn.onclick = () => checkAnswer(value);
      answerButtons.appendChild(btn);
    }

    // Kontroll av svar
    function checkAnswer(answer){
      // s√§kerst√§ll att vi bara r√§knar EN g√•ng per fr√•ga
      if(waitingForNext || answeredThisQuestion) return;
      answeredThisQuestion = true;
      waitingForNext = true;

      const q = questions[currentIndex];
      let feedbackHtml = '';
      if(answer === q.answer){
        correctCount++;
        playSound('correctSound');
        feedbackHtml = `<div class="feedback">‚úÖ R√§tt!<br>${q.explanation}</div>`;
        qBox.style.background = '#c8e6c9';
      } else {
        wrongCount++;
        playSound('wrongSound');
        feedbackHtml = `<div class="feedback">‚ùå Fel!<br>${q.explanation}</div>`;
        qBox.style.background = '#ffcdd2';
      }

      // Disable buttons visuellt s√• det inte ser ut som man kan klicka fler g√•nger
      const btns = answerButtons.querySelectorAll('button');
      btns.forEach(b => { b.disabled = true; b.style.opacity = '0.6'; });

      qBox.innerHTML = q.q + feedbackHtml;
      updateScore();
      updateProgress();
    }

    // Klick p√• fr√•gerutan: g√• vidare ENDAST efter svar (waitingForNext true)
    qBox.addEventListener('click', () => {
      // Om inget spel valt, starta standard (santfejk)
      if(!currentGame){
        startGame('santfejk');
        return;
      }
      if(!waitingForNext) return; // ignorera klick om vi inte v√§ntar p√• n√§sta
      waitingForNext = false;
      currentIndex++;
      showQuestion();
    });

    // Score / progress
    function updateScore(){
      scoreEl.innerText = `R√§tt: ${correctCount} | Fel: ${wrongCount}`;
    }
    function updateProgress(){
      const total = questions.length || 1;
      const pct = Math.round((currentIndex / total) * 100);
      progressBar.style.width = pct + '%';
    }

    // SLUTSK√ÑRM
    function showEndScreen(){
      endScreen.style.display = 'block';
      document.body.style.background = '#111';
      answerButtons.style.display = 'none';
      launchFireworks();
    }

    // Ljudspelare
    function playSound(id){
      const el = document.getElementById(id);
      if(!el) return;
      try { el.currentTime = 0; el.play(); } catch(e){ /* ignore */ }
    }

    // Fyrverkeri ‚Äî robust implementation
    function launchFireworks(){
      clearFireworks(); // rensa ev tidigare
      const canvas = document.getElementById('fireworksCanvas');
      const ctx = canvas.getContext('2d');
      function resize(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
      resize();
      window.addEventListener('resize', resize);

      let particles = [];
      function random(min,max){ return Math.random()*(max-min)+min; }

      function createFirework(){
        const x = random(80, canvas.width-80);
        const y = random(60, canvas.height/2);
        const count = 120;
        for(let i=0;i<count;i++){
          particles.push({
            x, y,
            dx: random(-4,4),
            dy: random(-4,4),
            life: Math.floor(random(40,120)),
            hue: Math.floor(random(0,360))
          });
        }
      }

      function animate(){
        // l√§tt "fade" s√• partiklar l√§mnar sp√•r, men canvas ligger bakom texten s√• det p√•verkar ej text
        ctx.fillStyle = 'rgba(0,0,0,0.12)';
        ctx.fillRect(0,0,canvas.width,canvas.height);

        for(let i = particles.length-1; i>=0; i--){
          const p = particles[i];
          ctx.fillStyle = `hsl(${p.hue}, 90%, 60%)`;
          ctx.beginPath();
          ctx.arc(p.x, p.y, 2.4, 0, Math.PI*2);
          ctx.fill();
          p.x += p.dx;
          p.y += p.dy;
          p.life--;
          if(p.life <= 0) particles.splice(i,1);
        }
        requestAnimationFrame(animate);
      }

      // skapa och animera
      animate();
      fireworksIntervalId = setInterval(createFirework, 900);
    }

    function clearFireworks(){
      if(fireworksIntervalId) { clearInterval(fireworksIntervalId); fireworksIntervalId = null; }
      // t√∂m canvas
      const canvas = document.getElementById('fireworksCanvas');
      if(canvas && canvas.getContext){
        const ctx = canvas.getContext('2d');
        ctx && ctx.clearRect(0,0,canvas.width,canvas.height);
      }
    }

    // Startknappar (OM anv√§ndaren klickar p√• mode-knapp)
    // Dessa knappar finns i HTML med onclick=startGame('santfejk') etc.

    // --- valfri initialisering: visa instruktion i rutan ---
    qBox.innerText = 'V√§lj ett spel ovan eller klicka i rutan f√∂r att starta standard (Sant/Fejk).';
  </script>
</body>
</html>
